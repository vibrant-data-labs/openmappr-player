doctype html
html(lang='en', data-ng-app='hcApp' style="background: #{backgroundColor}" )
	head
		meta(charset='utf-8')
		link(rel="icon"  href="#{player_prefix_index_source}/img/logos/vdl-logo.svg")
		meta(name="viewport", content="initial-scale=.7, user-scalable=no, minimal-ui")
		meta(name="apple-mobile-web-app-capable" content="yes")
		meta(property="fb:app_id", content="1389717224632761")
		meta(name="twitter:card", content="summary")
		meta(property="og:image", content="#{snapshotImg}")
		meta(property="og:title", content="openmappr | network exploration tool")
		meta(property="og:url", content="")
		meta(property="og:description", content="#{playerTitle}")
		meta(name="robots", content="noindex")
		title openmappr | #{playerTitle}
		meta(name="description", content="#{playerTitle}")
		link(rel="stylesheet", href="#{player_prefix_index_source}/css/mappr-icons/style.css")
		link(href="//maxcdn.bootstrapcdn.com/font-awesome/4.4.0/css/font-awesome.min.css", rel="stylesheet")
		link(href="https://fonts.googleapis.com/icon?family=Material+Icons" rel="stylesheet")
		link(href="https://fonts.googleapis.com/css?family=Roboto:300,500" rel="stylesheet")
		link(href="https://fonts.googleapis.com/css2?family=Poppins:wght@400;500;700&display=swap" rel="stylesheet")

		link(rel='stylesheet', href='#{player_prefix_index_source}/css/vendor.css')

		script.
			window.MP_APP = {};
			window.DATA_PATH = '#{playerDataPath}';

		link(rel='stylesheet', href='#{player_prefix_index_source}/css/player.debug.css')
		
		style.
			#auth-modal {
				display: none;
				position: fixed;
				top: 0;
				left: 0;
				width: 100%;
				height: 100%;
				background: rgba(0, 0, 0, 0.8);
				z-index: 9999;
			}
			.auth-content {
				position: absolute;
				top: 50%;
				left: 50%;
				transform: translate(-50%, -50%);
				background: white;
				padding: 20px;
				border-radius: 5px;
				text-align: center;
			}
			.auth-content input {
				margin: 10px 0;
				padding: 5px;
				width: 200px;
			}
			.auth-content button {
				padding: 5px 15px;
				background: #007bff;
				color: white;
				border: none;
				border-radius: 3px;
				cursor: pointer;
			}
			.auth-content button:hover {
				background: #0056b3;
			}

	body#app.nav-min(data-custom-background, data-off-canvas-nav style="background: #{backgroundColor}" class="#{colorTheme}-theme side-menu-compressed")
		#auth-modal
			.auth-content
				h2 Enter Password
				input#password-input(type="password" placeholder="Enter password")
				button#submit-password Submit

		div
			div.view-container
				div#content(style="background: #{backgroundColor}" data-ng-view='ng-view', data-close-min-nav='data-close-min-nav')

		div#svg-renderarea.hidden
		div(ng-include="'#{player_prefix_index}/components/project/distributions/renderers/renderTemplates.html'")

		script(src='https://cdnjs.cloudflare.com/ajax/libs/es5-shim/2.1.0/es5-shim.min.js')
		script(src='https://code.jquery.com/jquery-2.1.0.min.js')
		script(src='https://code.jquery.com/ui/1.10.4/jquery-ui.min.js')
		script(src='https://cdnjs.cloudflare.com/ajax/libs/angular.js/1.5.1/angular.min.js')
		script(src='https://cdnjs.cloudflare.com/ajax/libs/angular.js/1.5.1/angular-resource.min.js')
		script(src='https://cdnjs.cloudflare.com/ajax/libs/angular.js/1.5.1/angular-cookies.min.js')
		script(src='https://cdnjs.cloudflare.com/ajax/libs/angular.js/1.5.1/angular-sanitize.min.js')
		script(src='https://cdnjs.cloudflare.com/ajax/libs/angular-scroll/1.0.2/angular-scroll.min.js')
		script(src='https://cdnjs.cloudflare.com/ajax/libs/angular.js/1.5.1/angular-route.min.js')
		script(src='https://cdnjs.cloudflare.com/ajax/libs/angular.js/1.5.1/angular-animate.min.js')
		script(src='https://cdnjs.cloudflare.com/ajax/libs/angular.js/1.5.1/angular-touch.min.js')
		script(src='https://cdnjs.cloudflare.com/ajax/libs/angular-simple-logger/0.1.2/angular-simple-logger.min.js')
		script(src='https://cdnjs.cloudflare.com/ajax/libs/angular-ui-bootstrap/1.1.0/ui-bootstrap-tpls.min.js')
		script(src='https://cdn.jsdelivr.net/npm/angular-vs-repeat@1.1.7/src/angular-vs-repeat.min.js')
		script(src='https://cdnjs.cloudflare.com/ajax/libs/json3/3.2.6/json3.min.js')
		script(src='https://cdnjs.cloudflare.com/ajax/libs/lodash.js/3.10.1/lodash.min.js')
		script(src='https://cdnjs.cloudflare.com/ajax/libs/leaflet/1.3.0/leaflet.js')
		script(src='https://cdnjs.cloudflare.com/ajax/libs/angular-loading-bar/0.7.1/loading-bar.min.js')
		script(src='https://cdnjs.cloudflare.com/ajax/libs/d3/3.5.13/d3.min.js')
		script(src='https://cdnjs.cloudflare.com/ajax/libs/snap.svg/0.4.1/snap.svg-min.js')
		script(src='https://cdnjs.cloudflare.com/ajax/libs/ngInfiniteScroll/1.1.2/ng-infinite-scroll.min.js')
		script(src='https://cdnjs.cloudflare.com/ajax/libs/re-tree/0.0.2/re-tree.min.js')
		script(src='https://cdnjs.cloudflare.com/ajax/libs/angular-ui-slider/0.1.2/slider.min.js')
		script(src='https://cdnjs.cloudflare.com/ajax/libs/ng-device-detector/1.1.1/ng-device-detector.min.js')
		script(src='https://cdn.jsdelivr.net/npm/bootstrap-notify@3.1.3/bootstrap-notify.min.js')
		script(src='https://cdnjs.cloudflare.com/ajax/libs/toastr.js/2.1.1/toastr.min.js')
		script(src='https://cdnjs.cloudflare.com/ajax/libs/moment.js/2.10.6/moment.min.js')
		script(src='https://cdnjs.cloudflare.com/ajax/libs/twix.js/0.7.2/twix.min.js')
		script(src='https://cdnjs.cloudflare.com/ajax/libs/angular-audio/1.7.4/angular.audio.js')
		script(src='https://cdnjs.cloudflare.com/ajax/libs/intro.js/2.9.3/intro.min.js')
		script(src='https://cdn.jsdelivr.net/npm/angular-intro.js@3.4.0/src/deprecated.angular-intro.js')
		script(src='https://cdnjs.cloudflare.com/ajax/libs/html2canvas/0.4.1/html2canvas.min.js')
		script(src='https://cdnjs.cloudflare.com/ajax/libs/sql.js/0.3.2/js/sql.js')
		script(src='#{player_prefix_index_source}/js/player/vendor.js')
		script(src="#{player_prefix_index_source}/js/player.min.js")
		script(src='https://cdnjs.cloudflare.com/ajax/libs/crypto-js/4.1.1/crypto-js.min.js')
		script(src='https://cdnjs.cloudflare.com/ajax/libs/js-cookie/3.0.1/js.cookie.min.js')
		
		script.
			document.addEventListener('DOMContentLoaded', function() {
				const authModal = document.getElementById('auth-modal');
				const passwordInput = document.getElementById('password-input');
				const submitButton = document.getElementById('submit-password');
				const content = document.querySelector('.view-container');
				
				const correctHash = "ba525df500f817b5fb4b7210b686b534611da09a6f2c8200665ea38a7a3c782c";
				
				// Check if already authenticated
				if (Cookies.get('openmappr_authenticated')) {
					authModal.style.display = 'none';
					content.style.display = 'block';
					return;
				}
				
				// Hide the main content initially
				content.style.display = 'none';
				
				// Show the auth modal
				authModal.style.display = 'block';
				
				function checkPassword() {
					// Hash the input password
					const inputHash = CryptoJS.SHA256(passwordInput.value).toString();
					
					if (inputHash === correctHash) {
						// Set authentication cookie that expires in 24 hours
						Cookies.set('openmappr_authenticated', 'true', { expires: 1 });
						authModal.style.display = 'none';
						content.style.display = 'block';
					} else {
						alert('Incorrect password');
						passwordInput.value = '';
					}
				}
				
				submitButton.addEventListener('click', checkPassword);
				passwordInput.addEventListener('keypress', function(e) {
					if (e.key === 'Enter') {
						checkPassword();
					}
				});
			});
